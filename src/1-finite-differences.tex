\documentclass[a4paper,11pt]{article}

\usepackage{wrapfig}
\usepackage{amsmath}
%Russian-specific packages
%--------------------------------------
\usepackage[T2A]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage[russian, english]{babel}
%--------------------------------------

\title{01. Конечные разности и их свойства.}
\author{Андрей Бареков \and Ярослав Пылаев \and По лекциям Устинова С.М.}
\date{\today}

\begin{document}
\maketitle
\newpage

\section{Конечные разности}
\begin{minipage}{1\linewidth}
  \begin{wraptable}{l}{2.5cm}
    \begin{tabular}{ c|c }
      $x$ & $f(x)$ \\
      \hline
      $x_0$ & $f(x_0)$ \\
      $x_1$ & $f(x_1)$ \\
      $\cdots$ & $\cdots$ \\
      $x_m$ & $f(x_m)$
    \end{tabular}
    \vspace{1mm}
    \[x_k = x_0 + k \times h\]
  \end{wraptable}

  \begin{gather*}
    \Delta_h f(x_k) = f(x_{k+1} - f(x_k)) = f(x_0 + (k+1)h) - f(x_0 + kh) \\
    f_k \stackrel{\mathrm{def}}{=} f(k) \\
    \Delta f(k) = f(k+1) - f(k) = f_{k+1} - f_k
  \end{gather*}
\end{minipage}

\vspace{1.15cm}

  \subsection{Свойства конечных разностей}
  \begin{enumerate}
    \item \(\Delta \alpha = \alpha - \alpha = 0\)
    \item \(\Delta (\alpha \times f_k) = \alpha \Delta f_k\)
    \item \(\Delta (f_k + g_k) = \Delta f_k + \Delta g_k\)
    \item \(\Delta (f_k g_k) = f_{k+1} g_{k+1} - f_k g_k \pm f_{k+1} g_k = \\
        = f_{k+1} \Delta g_k + g_k \Delta f_k = f_k \Delta g_k + g_{k+1} \Delta f_k\)
    \item \(\Delta k^S = (k+1)^S - k^S = k^S + Sk^{S-1} + \frac{S(S-1)}{2!}k^{S-2} + \cdots - k^S =\)

        \vspace*{0.5mm}
        \(= \frac{S!}{1!(S-1)!}k^{S-1} + \frac{S!}{2!(S-2)!}k^{S-2} + \cdots + \frac{S!}{(S-1)!1!}k + 1\)

        \vspace*{1mm}
        Конечная разность от полинома степени $S$ это полином степени $S-1$.
  \end{enumerate}

  \subsection{Таблица конечных разностей}
  \begin{enumerate}
    \item \(\Delta a^k = a^{k+1} - a^k = a^k(a-1)\)
    \item \(\Delta \sin{k} = \sin{(k+1)} - \sin{k} = 2\sin{\frac{1}{2}}\cos{(k+\frac{1}{2})} \)
    \item \(\Delta \cos{k} = \cos{(k+1)} - \cos{k} = -2\sin{\frac{1}{2}}\sin{(k+\frac{1}{2})} \)
  \end{enumerate}
\newpage

\section{Разделённые разности}

\[f(x_k; x_{k+1}) = \frac{f_{k+1} - f_k}{x_{k+1} - x_k}\] \\

\textbf{Аналогично производным высших порядков вводятся разделённые разности:}

\begin{gather*}
  f(x_k; x_{k+1}; x_{k+2}) = \frac{f(x_{k+1}; x_{k+2}) - f(x_k; x_{k+1})}{x_{k+2} - x_k} \\
  \dots \\
  f(x_k; x_{k+1}; \dots; x_{k+s}) = \frac{f(x_{k+1}; x_{k+2}; \dots; x_{k+s})
      - f(x_k; x_{k+1}; \dots; x_{k+s-1})}{x_{k+s} - x_k}
\end{gather*}

\textbf{Аналогично вводятся конечные разности высших порядков:}

\begin{gather*}
  \Delta f_k = f_{k+1} - f_k \\
  \Delta^2 f_k = \Delta f_{k+1} - \Delta f_k = f_{k+2} - f_{k+1} - f_{k+1} + f_k = f_{k+2} - 2f_{k+1} + f_k \\
  \Delta^3 f_k = \Delta^2 f_{k+1} - \Delta^2 f_k = f_{k+3} - 3f_{k+2} + 3f_{k+1} - f_k \\
  \dots
\end{gather*}

Если узлы таблицы равноотстоящие, то можно использовать и конечные, и разделённые разности.

  \subsection{Связь между конечными и разделенными разностями для равноотстоящих узлов}

  \begin{gather*}
    f(x_k; x_{k+1}) = \frac{f_{k+1} - f_k}{x_{k+1} - x_k} = \frac{\Delta f_k}{h} \\
    f(x_k; x_{k+1}; x_{k+2}) = \frac{f(x_{k+1}; x_{k+2}) - f(x_k; x_{k+1})}{x_{k+2} - x_k}
        = \frac{\frac{\Delta f_{k+1}}{h} - \frac{\Delta f_k}{h}}{2h} = \frac{\Delta^2 f_k}{2h^2}
  \end{gather*}
  По индукции легко показать, что: \\
  \[f(x_k; x_{k+1}; \dots; x_{k+s}) = \frac{\Delta^s f_k}{s! \times h^s}\]
\newpage

\section{Суммирование функций}
\begin{equation}
  \Delta F(k) = \phi(k)
\end{equation}

\begin{equation}
  \begin{cases}
    F_1 - F_0 = \phi_0 \\
    F_2 - F_1 = \phi_1 \\
    \cdots \\
    F_{n+1} - F_n = \phi_n
  \end{cases} \Leftrightarrow F_{n+1} - F_0 = \sum_{k=0}^{n} \phi_k
  \label{eq:NtLbFormula}
\end{equation}

Уравнение (\ref{eq:NtLbFormula}) является дискретным аналогом формулы Ньютона-Лейбница.

  \subsection{Примеры}
  %TODO: Дополнить.

  \subsection{Формула Абеля суммирования по частям}
  \[\int_{a}^{b} u\,dv = uv \bigg|_{a}^{b} - \int_{a}^{b} v\,du\]
  \begin{equation}
    \begin{split}
      \int_{a}^{b} \bigg| \frac{d}{dx}(U(x)v(x)) = u(x)v(x) + U(x)\frac{dv(x)}{dx} \\
      \int_{a}^{b} u(x)v(x)\,dx = U(x)v(x) \bigg|_{a}^{b} - \int_{a}^{b} U(x)\frac{dv}{dx} \,dx
    \end{split}
  \end{equation}
  \hrule
  \marginpar
  {
    \begin{gather*}
      \begin{subarray}{1}
        (*) \\
        \Delta (f_k g_k) = f_k \Delta g_k + g_{k+1} \Delta f_k \\
        \Delta (f_k) = f_{k+1} - f_k \\
        \Delta U(k) = \sum_{i=0}^{k+1} u(i) - \\
        - \sum_{i=0}^{k} u(i) = u(k+1)
      \end{subarray}
    \end{gather*}
  }
  \begin{equation}
    \begin{split}
      \sum_{k=m}^{n} \bigg| \Delta(U_k v_k) = [ u_{k+1} v_{k+1} ]^{(*)} + U_k \Delta v_k \\
      \sum_{k=m}^{n} u_{k+1} v_{k+1} = U_k v_k \bigg|_{m}^{n+1} - \sum_{k=m}^{n} U_k \Delta v_k
    \end{split}
    \label{eq:SumByParts}
  \end{equation}

  Формула (\ref{eq:SumByParts}) - формула Абеля суммирования по частям. \\

  %It's a comment *
  \begin{gather*}
    \begin{subarray}{1}
      \Delta (f_k g_k) = f_k \Delta g_k + g_{k+1} \Delta f_k \\
      \Delta (f_k) = f_{k+1} - f_k \\
      \Delta U(k) = \sum_{i=0}^{k+1} u(i) - \sum_{i=0}^{k} u(i) = u(k+1) \\
    \end{subarray}
  \end{gather*}

  %TODO: add examples and move comment * to special zone

\newpage

\end{document}
